#Task 1

-- Provide a list of products with a base price greater than 500 and that are featured in promo type of 'BOGOF' (Buy One Get One Free). 
-- This information will help us identify high-value products that are currently being heavily discounted, which can be useful for evaluating our pricing and promotion strategies.

Select distinct product_name,
         base_price,promo_type
From Revenue 
where base_price >500 and promo_type="BOGOF";

---------------------------------------------------------------

#Task 2

-- Generate a report that provides an overview of the number of stores in each city.
-- The results will be sorted in descending order of store counts, allowing us to identify the cities with the highest store presence.
-- The report includes two essential fields: city and store count, which will assist in optimizing our retail operations.

Select city,count(distinct store_id) as Store_count
From Revenue
group by city
order by Store_count desc;

---------------------------------------------------------------

#Task 3

-- Generate a report that displays each campaign along with the total revenue generated before and after the campaign.
-- The report includes three key fields: campaign name, total_revenue(before_promotion), total revenue(after_promotion).
-- This report should help in evaluating the financial impact of our promotional campaigns. (Display the values in millions)

Select campaign_name,
       concat(round(sum(Revenue_Before_Promo)/1000000,2),'M') as Revenue_Before_Promotion,
       concat(round(sum(Revenue_After_Promo)/1000000,2),'M') as Revenue_After_Promotion
From Revenue 
group by campaign_name
order by campaign_name asc;

---------------------------------------------------------------

# Task 4

-- Produce a report that calculates the Incremental Sold Quantity (ISU%) for each category during the Diwali campaign.
-- Additionally, provide rankings for the categories based on their ISU%.
-- The report will include three key fields: category, isu%, and rank order.
-- This information will assist in assessing the category-wise success and impact of the Diwali campaign on incremental sales.

with cte1 as
(
    Select category,sum(ISU) as ISU,
           round(sum(ISU)/sum(`quantity_sold(before_promo)`)*100,2) as `ISU_%`
    From revenue 
    where campaign_name='Diwali'
    group by category
)

Select *,
       rank() over(ORDER BY `ISU_%` DESC) as ISU_rank
From cte1
order by `ISU_%` desc;

-----------------------------------------------------------------------

# Task 5

-- Create a report featuring the Top 5 products, ranked by Incremental Revenue Percentage (IR%), across all campaigns.
-- The report will provide essential information including product name, category, and ir%.
-- This analysis helps identify the most successful products in terms of incremental revenue across our campaigns, assisting in product optimization.

Select product_name,category,
       round(SUM(IR)/SUM(Revenue_Before_Promo)*100,2) as `IR%`,
       rank() over(order by SUM(IR)/SUM(Revenue_Before_Promo)*100 desc) as ranking
From Revenue 
group by product_name,category
order by `IR%` desc
limit 5;
